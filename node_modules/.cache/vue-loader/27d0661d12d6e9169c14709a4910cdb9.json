{"remainingRequest":"/home/hercules/funny/frontend/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/home/hercules/funny/frontend/src/views/ViewPost.vue?vue&type=style&index=0&id=4f65049f&lang=scss&scoped=true","dependencies":[{"path":"/home/hercules/funny/frontend/src/views/ViewPost.vue","mtime":1614290353890},{"path":"/home/hercules/funny/frontend/node_modules/css-loader/dist/cjs.js","mtime":1613869030000},{"path":"/home/hercules/funny/frontend/node_modules/vue-loader-v16/dist/stylePostLoader.js","mtime":1613869059000},{"path":"/home/hercules/funny/frontend/node_modules/postcss-loader/src/index.js","mtime":1613869046000},{"path":"/home/hercules/funny/frontend/node_modules/sass-loader/dist/cjs.js","mtime":1613869055000},{"path":"/home/hercules/funny/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1613869025000},{"path":"/home/hercules/funny/frontend/node_modules/vue-loader-v16/dist/index.js","mtime":1613869059000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICIuLi8uLi9ub2RlX21vZHVsZXMvYnVsbWEiOw0KI3RpdGxlIHsNCiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgbWFyZ2luLWJvdHRvbTogNXZoOw0KfQ0K"},{"version":3,"sources":["/home/hercules/funny/frontend/src/views/ViewPost.vue"],"names":[],"mappings":";AA0IA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAClC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAClB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AACtB","file":"/home/hercules/funny/frontend/src/views/ViewPost.vue","sourceRoot":"","sourcesContent":["<template>\r\n    <div>\r\n        <h2 class=\"title\" id=\"title\">{{post.title}}<span class=\"tag is-danger\" v-if=\"post.closed\">Closed</span></h2>\r\n        <div class=\"message\"></div>\r\n        <div class=\"columns\">\r\n            <div class=\"column\">\r\n                <div class=\"box\">\r\n                    <figure class=\"image is-128x28\">\r\n                        <img :src=\"post.image\">\r\n                    </figure>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"column\">\r\n                <div class=\"box\">\r\n                    <p>{{post.desc}}</p>\r\n                    <hr>\r\n                    <p>Current Bid: <strong>${{highest.bid}}</strong> by <strong>{{highest.bidder[\"username\"]}}#{{highest.bidder[\"id\"]}}</strong></p>\r\n                </div>\r\n                <hr>\r\n                <div class=\"box\">\r\n                    <h5 class=\"subtitle\">By <strong>{{post.host.username}}#{{post.host.id}}</strong></h5>\r\n                </div>\r\n                <div>\r\n                    <div class=\"field has-addons has-addons-centered\">\r\n                        <p class=\"control\">\r\n                            <span class=\"select\">\r\n                            <select v-model=\"unit\">\r\n                                <option value=\"$\">$</option>\r\n                                <option value=\"£\">£</option>\r\n                                <option value=\"€\">€</option>\r\n                                <option values=\"¥\">¥</option>\r\n                            </select>\r\n                            </span>\r\n                        </p>\r\n                        <p class=\"control\">\r\n                            <input class=\"input\" type=\"text\" placeholder=\"Amount of money\" v-model=\"bid\" id=\"bid_val\">\r\n                        </p>\r\n                        <p class=\"control\">\r\n                            <button class=\"button is-primary\" :disabled=\"post.closed\" @click=\"submit()\" id=\"submit_bid\">\r\n                            Place Bid\r\n                            </button>\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport $ from \"jquery\";\r\n    export default {\r\n        name: \"ViewPost\",\r\n        data() {\r\n            return {\r\n                bid: 0,\r\n                post: {\r\n                    'title': 'Loading...',\r\n                    'closed': false,\r\n                    'image': 'Loading...',\r\n                    'desc': 'Loading...',\r\n                    'host': {\r\n                        'username': 'Loading...',\r\n                        'id': 'Loading...'\r\n                    }\r\n                },\r\n                unit: '',\r\n                amount: '',\r\n                highest: {\r\n                    bid: 0,\r\n                    bidder: {\r\n                        'username': 'Loading...',\r\n                        'id': 'Loading...'\r\n                    }\r\n                },\r\n                currencies: '',\r\n                rates: ''\r\n            }\r\n        },\r\n        mounted() {\r\n             fetch(\"https://api.exchangeratesapi.io/latest?base=USD\").then(res => res.json()).then(data => {\r\n                this.rates = data.rates\r\n            })\r\n            fetch(\"https://127.0.0.1:8000/api/post/\" + this.$route.params.id).then(res => res.json()).then(data => {\r\n                console.log(data);\r\n                this.post = data.post[0]\r\n                this.highest = data.highest\r\n            })\r\n        },\r\n        methods: {\r\n            convert() {\r\n                let currencies = {\r\n                    '€': \"EUR\",\r\n                    '£': \"GBP\",\r\n                    '¥': \"JPY\",\r\n                    '$': \"USD\"\r\n                }\r\n                this.amount = (1 / this.rates[currencies[this.unit]]) * this.bid\r\n            },\r\n \r\n            submit() {\r\n                this.convert()\r\n                $(\"#submit_bid\").prop(\"class\", \"button is-primary is-loading\")\r\n                $(\"#submit_bid\").prop(\"disabled\", true)\r\n                let body = {\r\n                    post: this.post.id,\r\n                    user: JSON.parse(window.localStorage.getItem('user')).id,\r\n                    bid: this.amount\r\n                    }\r\n                console.log(\"Body: \" ); console.log(body)\r\n                fetch(\"http://127.0.0.1:8000/api/bid\", {\r\n                    method: 'PUT',\r\n                    body: JSON.stringify(body)\r\n                }).then(res => res.json())\r\n                .then(data => {\r\n                    console.log(data)\r\n                    const alert = document.createElement(\"article\")\r\n                    alert.className = data.class\r\n                    alert.innerHTML = `\r\n                        <div class=\"message-header\">\r\n                            <p>${data.message}</p>\r\n                            <button class=\"delete\" aria-label=\"delete\" onclick=\"document.querySelector('.message').innerHTML = ''\"</button>\r\n                        </div>\r\n                    `\r\n                    alert.id = \"alert\"\r\n                    $(\".message\").html(\"\")\r\n                    document.querySelector(\".message\").appendChild(alert)\r\n                    $(\"#submit_bid\").attr(\"class\", \"button is-primary\")\r\n                    $(\"#submit_bid\").attr(\"disabled\", false)\r\n                    this.highest =  data.last_bid\r\n                })\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"../../node_modules/bulma\";\r\n#title {\r\n    text-align: center;\r\n    margin-bottom: 5vh;\r\n}\r\n</style>\r\n"]}]}